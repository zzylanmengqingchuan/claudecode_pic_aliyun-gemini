# 专业头像生成器

这是一个基于 Web 的专业头像生成应用，使用 Google Gemini API 实现真实的 AI 头像生成。

## 功能特性

✅ **已完成（里程碑 1 + 里程碑 2）**
- 📤 图片上传功能（支持拖拽和点击选择）
- ✅ 文件格式验证（JPG, PNG, WEBP）
- ✅ 文件大小验证（最大 10MB）
- 🎨 三种风格选择（商务正式、创意活力、艺术写真）
- 👀 实时图片预览
- ⚡ 生成进度动画
- 📊 原图与生成图并排对比展示
- 💾 下载生成的头像
- 🔄 重新生成功能
- 📱 响应式设计（支持桌面和移动端）
- 🤖 **已接入 Google Gemini API**
- 🎯 **真实的 AI 头像生成**

## 快速开始

### 前置要求

- Node.js 14+ 已安装
- Google Gemini API Key（已配置在 .env 文件中）

### 安装步骤

1. **安装依赖**
```bash
npm install
```

2. **启动后端服务**
```bash
npm start
```

服务将在 `http://localhost:3000` 启动

3. **打开前端页面**

在浏览器中访问：
```
http://localhost:3000
```

或直接打开 `index.html` 文件（需要后端服务运行）

## 使用说明

### 1. 上传照片
- 点击上传区域选择文件，或直接拖拽图片到上传区
- 支持的格式：JPG, PNG, WEBP
- 文件大小限制：10MB

### 2. 选择风格
上传成功后，从三种风格中选择一种：
- **商务正式**：适合 LinkedIn、求职简历、企业官网
- **创意活力**：适合社交媒体、个人品牌、创意行业
- **艺术写真**：适合艺术家简介、个人作品集

### 3. 生成头像
- 点击"生成专业头像"按钮
- 等待 2-3 秒（模拟 AI 生成过程）
- 查看生成结果

### 4. 下载或重新生成
- 点击"下载头像"保存生成的图片
- 点击"重新生成"使用相同设置再次生成
- 点击"返回首页"重新开始

## 项目结构

```
test07/
├── index.html          # 主 HTML 文件
├── styles.css          # 样式文件
├── app.js              # JavaScript 逻辑
├── spec.md             # 项目规格说明书
└── README.md           # 本文件
```

## 技术栈

### 前端
- **HTML5** - 页面结构
- **CSS3** - 样式和动画
- **Vanilla JavaScript** - 交互逻辑
- **FileReader API** - 图片预览
- **Fetch API** - API 调用

### 后端
- **Node.js** - 运行环境
- **Express** - Web 框架
- **Multer** - 文件上传处理
- **Google Gemini API** - AI 图像生成
- **dotenv** - 环境变量管理

## API 集成说明

本项目使用 **Google Gemini 2.5 Flash Image** 模型进行图像生成，具有以下特点：

### 三种风格的 Prompt 设计

1. **商务正式风格**
   - 专业的商务头像
   - 简洁的背景
   - 正装造型
   - 适合 LinkedIn、简历等

2. **创意活力风格**
   - 充满活力的构图
   - 丰富的色彩
   - 现代时尚的外观
   - 适合社交媒体

3. **艺术写真风格**
   - 电影般的质感
   - 戏剧性的光影
   - 艺术化处理
   - 适合艺术家作品集

### API 配置

- 使用 SDK: `@google/genai` (官方 Node.js SDK)
- 模型: `gemini-2.5-flash-image`
- 认证方式: API Key
- 输入格式: Base64 编码的图片 + 文本 Prompt
- 输出格式: Base64 编码的生成图片

## 项目结构

```
test07/
├── index.html          # 主 HTML 文件
├── styles.css          # 样式文件
├── app.js              # 前端 JavaScript（已更新为调用真实 API）
├── server.js           # Node.js 后端服务
├── package.json        # Node.js 依赖配置
├── .env                # 环境变量（包含 API Key）
├── .gitignore          # Git 忽略文件
├── spec.md             # 项目规格说明书
└── README.md           # 本文件
```

## 核心功能实现

### 文件验证
- 客户端和服务端双重文件类型检查
- 文件大小限制验证（10MB）
- 友好的错误提示

### 交互体验
- 拖拽上传支持
- 实时预览
- 流畅的页面切换动画
- 加载状态指示
- 完善的错误处理

### AI 图像生成
- 使用 Google Gemini 2.5 Flash Image 模型
- 支持图像到图像的转换（Image-to-Image）
- 三种专业风格的 Prompt 优化
- 保持人物面部特征和相似度
- Base64 图片编码传输
- 官方 @google/genai SDK 集成

## 浏览器兼容性

支持所有现代浏览器：
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 验收标准检查

根据 spec.md 里程碑 2 的验收标准：

- [x] Google Gemini API 成功接入
- [x] 三种风格都能正确生成对应风格的头像
- [x] 错误情况有完善的处理和提示
- [x] API 密钥等敏感信息安全存储（.env 文件）
- [x] 所有功能可以正常运行

## 测试指南

### 1. 基础功能测试
- 上传不同格式的图片（JPG, PNG, WEBP）
- 测试文件大小限制（尝试上传 >10MB 的文件）
- 测试不支持的格式（如 GIF）

### 2. AI 生成测试
- 分别测试三种风格的生成效果
- 检查生成的图片是否符合风格描述
- 测试"重新生成"功能

### 3. 错误处理测试
- 在未启动后端服务时测试前端（应显示错误）
- 测试网络中断情况
- 测试 API 调用失败的处理

### 4. 响应式测试
- 在不同设备上测试（桌面、平板、手机）
- 使用浏览器开发者工具模拟不同屏幕尺寸

## 注意事项

1. **API Key 安全**
   - API Key 存储在 `.env` 文件中，不应提交到 Git
   - `.gitignore` 已配置忽略 `.env` 文件
   - 生产环境应使用环境变量

2. **API 使用限制**
   - Google Gemini API 可能有调用频率限制
   - 建议监控 API 使用量和费用
   - 大约 $0.039 每张图片

3. **图片处理**
   - 上传的图片会临时保存到 `uploads/` 目录
   - 生成完成后会自动清理临时文件
   - 确保服务器有足够的磁盘空间

## 故障排除

### 问题：无法连接到后端服务
- 确认后端服务已启动（`npm start`）
- 检查端口 3000 是否被占用
- 查看控制台是否有错误信息

### 问题：API 调用失败
- 检查 `.env` 文件中的 API Key 是否正确
- 确认网络连接正常
- 查看服务器日志中的详细错误信息

### 问题：生成的图片不符合预期
- 尝试使用不同的源图片
- 尝试不同的风格
- 检查 Prompt 是否需要优化

## 未来优化方向

- [ ] 支持更多风格选择
- [ ] 批量生成功能
- [ ] 用户历史记录
- [ ] 社交分享功能
- [ ] 高级参数调整（亮度、对比度等）
- [ ] 用户反馈和评分系统
- [ ] 使用 Imagen 3 模型获得更高质量
- [ ] 添加图片质量选择
- [ ] 支持不同宽高比

## 许可证

本项目仅用于学习和演示目的。
