# 🎯 Dove VPN (端口3100) - 最终操作步骤

## ✅ 你的配置

根据截图，你的 Dove VPN 配置：
- **本地端口**: 3100 ✓
- **服务器**: 美国标准节点1 ✓
- **代理模式**: 全局模式 ✓

配置完全正确！

---

## 🚀 现在只需 3 步

### 步骤 1：确保 Dove VPN 已连接
- 点击 Dove 界面上的"连接"按钮
- 等待连接成功（显示"已连接"）
- 节点选择：美国标准节点（已选好）

### 步骤 2：双击运行启动脚本
**双击运行 `start-dove.bat`**

这个脚本会：
1. 检查 Dove VPN 是否连接
2. 配置代理端口 3100
3. 启动服务器

### 步骤 3：测试功能
1. 浏览器打开 `http://localhost:3000`
2. 上传人物照片
3. 选择风格（商务/创意/艺术）
4. 点击"生成专业头像"
5. 等待 20-30 秒查看结果

---

## ✅ 成功标志

### 启动脚本输出
```
[1/3] 检查 Dove VPN 连接...
✓ Dove VPN 连接正常

[2/3] 配置代理环境变量...
✓ 代理已配置: http://127.0.0.1:3100

[3/3] 启动专业头像生成器...
============================================
服务地址: http://localhost:3000
代理端口: 3100 (Dove VPN)
============================================

专业头像生成器服务已启动
API Key 已配置: 是
使用模型: gemini-2.5-flash-image
```

### 生成图片时
服务器日志显示：
```
收到生成头像请求
处理图片: upload-xxxxx.jpg, 风格: creative
调用 Gemini API...
发送 HTTPS 请求到 Gemini API...
API 响应状态码: 200  ← 成功！
成功提取生成的图片
图片生成成功
```

**不再是** `ETIMEDOUT` 错误 ✓

---

## ❌ 如果启动脚本显示连接失败

### 检查：
1. Dove VPN 是否真的已连接（界面显示"已连接"）
2. 在浏览器测试能否访问 `https://www.google.com`
3. Dove 代理模式是否设置为"全局模式"（不是规则模式）

### 如果浏览器能访问 Google 但脚本还是失败
可能需要在 Dove 设置中启用"允许来自局域网的连接"：
1. 打开 Dove 设置
2. 查找"高级设置"或"网络设置"
3. 启用"允许来自局域网的连接"

---

## 📋 重要提示

### 每次使用都要：
1. ✅ 先启动 Dove VPN 并连接
2. ✅ 然后运行 `start-dove.bat`
3. ✅ 不要直接运行 `npm start`（不会使用代理）

### 如果要停止服务器：
在运行脚本的窗口按 **Ctrl+C**

---

## 🎉 准备就绪！

你的配置完全正确：
- ✅ Dove VPN 端口: 3100
- ✅ 美国节点
- ✅ 全局模式
- ✅ 启动脚本已准备好

**现在就试试吧：双击 `start-dove.bat`！** 🚀
